\section{Introduction}

Integrated Assessment Models (IAMs) are tools used to understand the complex
interactions between energy systems, economic systems, land use, the climate,
and air pollution, among other sectors . IAMs provide global projections of
systemic change by dividing the world into a number of representative regions
(typically 10 to 30), the definition of which is distinct for each model
\cite{krey_global_2014}. Results from IAMs are integral in a number of
international studies, which notably include projections of climate and economic
futures. Recently, flagship IAMs have developed scenarios based on the Shared
Socioeconomic Pathways (SSPs) \cite{van_vuuren_energy_2017, fricko_marker_2017,
  fujimori_ssp3:_2017, calvin_ssp4:_2017, kriegler_fossil-fueled_2017} which
quantify a variety of potential global futures. The SSPs are primarily designed
to be used in analyses of broad climate research which include earth system
model (ESM) simulations, climate impact, adaptation and climate mitigation
studies. They are regularly assessed by the United Nations' Intergovernmental
Panel on Climate Change (IPCC) across working groups.

While IAMs are implemented in myriad ways, including simulation and
optimization, the core inputs, outputs, and purpose are similar across different
models. Modeling teams incorporate existing data sets of energy systems, land
use, economics, demographics and emissions sources and concentrations, among other
data, in order to provide consistent historical trajectories of modeled
variables. The models then provide estimates of future trajectories of these
variables under various socioeconomic and technological assumptions as well as
proposed policy constraints, e.g., targets for future Greenhouse Gas (GHG)
emissions.

The emissions trajectories calculated by IAMs are critical inputs for ongoing,
worldwide scientific community efforts in the Coupled Model Intercomparison
Project Phase 6 (CMIP6) \cite{eyring_overview_2016}, which is utilizing a number
of marker SSP scenarios developed by the IAM community
\cite{oneill_scenario_2016}. These trajectories are endogenously calculated by
modeling the individual technologies and sectors that contribute towards the
emissions of different air pollutants and GHGs as well as various mitigation
technologies (e.g., NOx and SOx scrubbers on power plants). However, the
historical emissions inventories calculated by different models can differ by
large amounts depending on the region, sector, and emissions species being
modeled.

In practice, IAMs calculate the total source intensity of emitting technologies,
for example the total activity of coal power plants in China, and incorporate
emissions-intensity factors for individual gas species, for example the quantity
of sulfur emissions from coal plants per megawatt-hour of production, in order
to determine total emissions of a given gas species from a given
technology. Models are then \textit{calibrated} to historical data sources which
provide a combination of the activity of emitting technologies and trajectories
of past emissions in order to determine historical emissions trajectories in
each model region for each technology. Due to the sometimes large uncertainties
in historical datasets, results in the historical period may differ between
models.

With some frequency, historical data is updated to incorporate new assumptions
of source activity, new emissions accounting practices, or other concerns. The
global climate change community has recently developed a standard historical
emissions dataset for both anthropogenic emissions (i.e., the Community
Emissions Data System (CEDS) \cite{hoesly_historical_2017} and land-use change
(LUC) emissions \cite{van_marle_historic_2017}) which, in
% * <sfujimori112256@gmail.com> 2017-06-07T09:59:35.820Z:
% 
% > land-use change (LUC) emissions \cite{van_marle_historic_2017}
% I think this one also anthropogenic
% 
% ^.
conjunction with the SSP IAM trajectories, will be used for climate-related
modeling exercises of CMIP6.

When participating in intercomparison exercises in which consistency of
historical trajectories is required (e.g., in CMIP6), model teams incorporate a
single, common historical dataset through \textit{harmonization} in order to
enhance comparability across models. Harmonization describes the process of
adjusting model results to incorporate new historical time series while
maintaining critical aspects of and providing a smooth transition to modeled
future trajectories such that the resulting trajectories are consistent with the
original modeled results and usable by other members of the scientific community
involved in the exercise. In the emissions context, this means that each
individual combination of model region, model sector, and emissions species must
be harmonized. Depending on the total number of model regions, sectors, and
emissions species, this can require the selection of thousands to
tens-of-thousands of harmonization methods.

Harmonization has been addressed in previous studies as it is a common practice
in the IAM and climate change communities. For example,
\cite{meinshausen_rcp_2011} describes the use of scaling routines for the 5
regions used in the Special Report on Emissions Scenarios (SRES)
\cite{nakicenovic2000}; however, only total emissions were harmonized in the
exercise, thus there is no sectoral dimension. Further,
\cite{rogelj_discrepancies_2011} describes the impacts of choosing various
harmonization routines on future trajectories. During the evaluation of the
Representative Concentration Pathways (RCPs), IAM results have been harmonized
by sector and the 5 RCP global regions
\cite{vuuren_representative_2011}. Importantly, the choice of harmonization
method to date has been determined via expert solicitation and has generally
been applied to all trajectories for a given class of emissions species.

Climate modeling efforts have continued to progress, demanding increased spatial
and sectoral resolution from IAMs. Furthermore, a new generation of climate
scenarios which combines aspects of both the RCPs and SSPs have been developed
in order to incorporate both physical and socioeconomic detail. In order to
address the growing dimensionality of model outputs and support ongoing scenario
generation and analysis efforts while still providing a consistent and
scientifically rigorous harmonization procedure, an automated process for
determining harmonization methods is needed. The use of an automated,
documented, and openly available harmonization mechanism additionally allows for
full procedural reproducibility and for direct participation by additional
modeling teams not involved in the original exercise.

The remainder of this paper describes the methodology and implementation of the
\code{aneris} code base \cite{matthew_gidden_2017_802832}, written in the Python
programming language (detailed documentation available
\href{http://mattgidden.com/aneris/}{online}). Section \ref{sec:meths} provides
a detailed description of the underlying mathematical components of
\code{aneris} as well as the code workflow. The results of applying the
automated harmonization mechanism on two example IAM scenarios, one with
emissions growth and another with emissions mitigation, is presented in Section
\ref{sec:results}. Finally, the general effectiveness and potential future
improvements on the automated methodology is discussed in Section
\ref{sec:future}.

% todo: add?
% what aspects of harmonization are important (e.g., cumulative carbon emissions).
